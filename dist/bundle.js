(()=>{"use strict";const t=function(){function t(t){var i=this;this.game=t,this.height=64,this.width=64,this.position={x:468,y:386},this.facingDirection="left",this.imageLoadedLeft=!1,this.imageLoadedRight=!1,this.playerImageLeft=new Image,this.playerImageLeft.src="../assets/img/player.png",this.playerImageLeft.onload=function(){i.imageLoadedLeft=!0},this.playerImageRight=new Image,this.playerImageRight.src="../assets/img/player_right.png",this.playerImageRight.onload=function(){i.imageLoadedRight=!0},this.speed=0,this.verticalSpeed=0,this.moveRate=5,this.jumpRate=10,this.maxFallingHeight=0,this.timeouts=[]}return t.prototype.draw=function(){this.imageLoadedLeft&&"left"===this.facingDirection&&this.game.ctx.drawImage(this.playerImageLeft,this.position.x,this.position.y,this.width,this.height),this.imageLoadedRight&&"right"===this.facingDirection&&this.game.ctx.drawImage(this.playerImageRight,this.position.x,this.position.y,this.width,this.height);var t=this.position.y+this.height;this.game.ctx.fillText(t.toString(),this.position.x,this.position.y+this.height),this.game.ctx.fillText(this.position.y.toString(),this.position.x,this.position.y)},t.prototype.update=function(t){this.verticalSpeed<=0&&!this.isJumping&&(this.verticalSpeed=7),this.position.x+=this.speed,this.position.y+=this.verticalSpeed,this.position.x<=0&&(this.position.x=0),this.position.x+this.width>=this.game.width&&(this.position.x=this.game.width-this.width),this.detectColisionWithPlatform(),this.position.y>=this.maxFallingHeight&&(this.position.y=this.maxFallingHeight),this.position.y<=0&&(this.position.y=0)},t.prototype.moveRight=function(){this.speed=this.moveRate,this.facingDirection="right"},t.prototype.moveLeft=function(){this.speed=-this.moveRate,this.facingDirection="left"},t.prototype.stopMovement=function(){this.speed=0},t.prototype.jump=function(){var t=this;if(!this.isJumping){this.isJumping=!0,this.verticalSpeed=-this.jumpRate;var i,e=null,s=null;i=setTimeout((function(){t.verticalSpeed=0,e=setTimeout((function(){t.verticalSpeed=t.jumpRate,s=setTimeout((function(){t.verticalSpeed=0,t.isJumping=!1}),250)}),150)}),250),this.timeouts.push(i,e,s)}},t.prototype.stopJumping=function(){this.timeouts.forEach((function(t){clearTimeout(t)})),this.verticalSpeed=0,this.isJumping=!1},t.prototype.detectColisionWithPlatform=function(){var t=this,i=!1;this.game.platforms.forEach((function(e){t.position.x>=e.position.x-t.width&&t.position.x<=e.position.x+e.width&&t.position.y<e.position.y&&t.position.y+t.height<e.position.y+e.height&&(t.maxFallingHeight=e.position.y-t.height,i=!0),t.position.x>=e.position.x-t.width&&t.position.x<=e.position.x+e.width&&10*Math.ceil(t.position.y/10)==10*Math.ceil((e.position.y+e.height)/10)&&t.stopJumping()})),i||(this.maxFallingHeight=this.game.height-this.height)},t}(),i=function(t){var i=this;this.game=t,document.addEventListener("keydown",(function(t){switch(t.keyCode){case 37:i.game.player.moveLeft();break;case 38:i.game.player.jump();break;case 39:i.game.player.moveRight()}})),document.addEventListener("keyup",(function(t){switch(t.keyCode){case 37:"left"===i.game.player.facingDirection&&i.game.player.stopMovement();break;case 39:"right"===i.game.player.facingDirection&&i.game.player.stopMovement()}}))},e=function(){function t(t,i,e,s){var h=this;this.imageLoaded=!1,this.height=40,this.width=s,this.position={x:i,y:e},this.game=t,this.image=new Image,this.image.src="../assets/img/construction.png",this.image.onload=function(){h.imageLoaded=!0}}return t.prototype.draw=function(){this.game.ctx.fillStyle="red",this.game.ctx.fillStyle="blue";var t=this.position.y;if(this.game.ctx.fillText(t.toString(),this.position.x,this.position.y),this.game.ctx.fillText(this.height.toString(),this.position.x+this.width,this.position.y+this.height),this.imageLoaded){var i=this.game.ctx.createPattern(this.image,"repeat");this.game.ctx.fillStyle=i,this.game.ctx.fillRect(this.position.x,this.position.y,this.width,this.height)}},t}();const s=function(){function s(){var e;this.renderObjects=[];var s=document.getElementById("game");this.ctx=s.getContext("2d"),this.width=s.clientWidth,this.height=s.clientHeight,this.lastTime=0,this.ctx.clearRect(0,0,s.width,s.height),this.player=new t(this),this.player.draw(),this.platforms=this.generatePlatforms(),(e=this.renderObjects).push.apply(e,function(){for(var t=0,i=0,e=arguments.length;i<e;i++)t+=arguments[i].length;var s=Array(t),h=0;for(i=0;i<e;i++)for(var o=arguments[i],n=0,a=o.length;n<a;n++,h++)s[h]=o[n];return s}(this.platforms,[this.player])),new i(this)}return s.prototype.start=function(){requestAnimationFrame(this.gameLoop.bind(this))},s.prototype.gameLoop=function(t){var i=t-this.lastTime;this.lastTime=t,this.ctx.clearRect(0,0,this.width,this.height),this.renderObjects.forEach((function(t){"update"in t&&t.update(i),"draw"in t&&t.draw()})),requestAnimationFrame(this.gameLoop.bind(this))},s.prototype.generatePlatforms=function(){var t=[],i=new e(this,200,450,600),s=new e(this,0,300,200),h=new e(this,800,300,200),o=new e(this,200,150,600);return t.push(i,s,h,o),t},s}();new function(){this.game=new s,this.game.start()}})();